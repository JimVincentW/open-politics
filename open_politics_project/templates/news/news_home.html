{% extends "base.html" %}
{% load static %}
{% block news_home %}

{% include 'news/hero_tools.html' %}

<!-- Include HTMX -->
<script src="https://unpkg.com/htmx.org"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        var wsStart = 'ws://';
        if (window.location.protocol === 'https:') {
            wsStart = 'wss://';
        }
        var endpoint = wsStart + window.location.host + window.location.pathname;
        var socket = new WebSocket(endpoint);

        socket.onmessage = function(e) {
            console.log('Message:', e);
            var data = JSON.parse(e.data);
            var message = data['message'];
            document.getElementById('messages-area').innerText += '\n' + message;
        }

        socket.onopen = function(e) {
            console.log('Open', e);
        }

        socket.onerror = function(e) {
            console.log('Error', e);
        }

        socket.onclose = function(e) {
            console.log('Close', e);
        }

        document.getElementById('send-button').onclick = function(e) {
            var messageInput = document.getElementById('message-input');
            var message = messageInput.value;
            socket.send(JSON.stringify({'message': message}));
            messageInput.value = '';
        }
    });
</script>

{% endblock %}

