{% extends 'base.html' %}
{% block content %}
<head>
    <style> body { margin: 0; } </style>
  
    <script src="//unpkg.com/react/umd/react.production.min.js"></script>
    <script src="//unpkg.com/react-dom/umd/react-dom.production.min.js"></script>
    <script src="//unpkg.com/@babel/standalone"></script>
  
    <script src="//unpkg.com/react-globe.gl"></script>
    <!--<script src="../../dist/react-globe.gl.js"></script>-->
  </head>
  
  <body>
  <div id="globeViz"></div>
  <div id="globeVizWithHover"></div>

  <script type="text/jsx">
    // Gen random data
    const N = 10;
    const berlinCoords = {
        lat: 52.520008,
        lng: 13.404954,
        maxR: 10,
        propagationSpeed: 50,
        repeatPeriod: 20
      };
      
      // Add Berlin coordinates to gData array
      const gData = [
    { ...berlinCoords, city: 'Berlin' },
    ...Array(N-1).keys().map(() => ({
        lat: (Math.random() - 0.5) * 180,
        lng: (Math.random() - 0.5) * 360,
        maxR: Math.random() * 20 + 3,
        propagationSpeed: (Math.random() - 0.5) * 20 + 1,
        repeatPeriod: Math.random() * 2000 + 200,
        city: 'Random City',
    })),
    ];
  
    const colorInterpolator = t => `rgba(255,100,50,${Math.sqrt(1-t)})`;
  
    ReactDOM.render(
      <Globe
        globeImageUrl="//unpkg.com/three-globe/example/img/earth-night.jpg"
        ringsData={gData}
        ringColor={() => colorInterpolator}
        ringMaxRadius="maxR"
        ringPropagationSpeed="propagationSpeed"
        ringRepeatPeriod="repeatPeriod"
      />,
      document.getElementById('globeViz')
      document.getElementById('globeVizWithHover')

    );
    const HoverWindow = ({ data }) => (
  <div style={{
    position: 'absolute',
    top: data.pointerY,
    left: data.pointerX,
    padding: '10px',
    background: 'rgba(0, 0, 0, 0.8)',
    color: '#fff',
    borderRadius: '5px',
    fontSize: '14px',
    pointerEvents: 'none',
  }}>
    <div>City: {data.city}</div>
    <div>Latitude: {data.lat}</div>
    <div>Longitude: {data.lng}</div>
  </div>
);

ReactDOM.render(
  <Globe
    globeImageUrl="//unpkg.com/three-globe/example/img/earth-night.jpg"
    ringsData={gData}
    ringColor={() => colorInterpolator}
    ringMaxRadius="maxR"
    ringPropagationSpeed="propagationSpeed"
    ringRepeatPeriod="repeatPeriod"
    onRingHover={hoverD => hoverD && hoverD.city === 'Berlin' && (
      <HoverWindow data={{
        pointerX: hoverD.pointerX,
        pointerY: hoverD.pointerY,
        city: 'Berlin',
        lat: berlinCoords.lat,
        lng: berlinCoords.lng,
      }} />
    )}
  />,
  document.getElementById('globeViz')
);
  </script>
  </body>
{% endblock %}